<!DOCTYPE html><html><head><meta charset="utf-8"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="yes" name="apple-touch-fullscreen"><meta content="telephone=no,email=no" name="format-detection"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"><link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"><link href="https://fonts.googleapis.com/css?family=Rubik" rel="stylesheet"><script src="https://use.fontawesome.com/adaf0e149c.js"></script><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/monokai_sublime.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/post.css"><link rel="stylesheet" href="/css/markdown-github.css"><title>林水溶的博客</title><script src="/js/googleAnalytics.js"></script></head><body><div id="postContainer"><div id="postTop"><h4 id="logo">Life Is Short</h4><br><br><h2 id="postTitle">跨域访问的解决方法</h2><br><span aria-hidden="true" class="postTime fa fa-calendar">2016-10-16</span><span aria-hidden="true" class="postTags fa fa-tags">&nbsp;JavaScript</span><span aria-hidden="true" class="postTags fa fa-tags">&nbsp;API</span><span aria-hidden="true" class="postTags fa fa-tags">&nbsp;Wikipedia</span><br><br></div><section id="articleDiv"><p><strong>10-18补充：</strong></p><br><p>解决跨域的问题，只要你清楚这两个概念就够了：</p><br><ul><br><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="external">跨域访问（Cross-site HTTP request）的详细介绍。</a></li><br><li><a href="http://www.cnblogs.com/dowinning/archive/2012/04/19/json-jsonp-jquery.html" target="_blank" rel="external">谈谈JSON和JSONP的区别</a></li><br></ul><br><hr><br><p><em>我在调用Wiki的API时又遇到了跨域访问问题，第二次了</em></p><br><blockquote><br><p>No ‘Access-Control-Allow-Origin’ header is present on the requested resource.<br>Origin ‘null’ is therefore not allowed access.</p><br></blockquote><br><p>第一次是调用聚合天气的数据时，我用jQuery的.ajax()获取数据时遇到了这个问题。当时着实困扰了我好久。在网上搜了搜也还是不知道如何解决。后来参考了别的同学的代码，看他在获取数据时用的是.getJSON()，我也换成了这方法，果然没有上面的问题了。但是我不知道问题的原因，以及为何换个方法就不会出现。现在还是不知道（过段时间http协议相关的书还是要看的，看了之后应该就知道这个问题该如何解决了吧）。</p><br><hr><br><p>这个问题是如何出现的，以及如何解决网上也有方法，不过要是没有解决你的问题的话，不妨看看这个：</p><br><blockquote><br><p>If you want to load an api URL from another domain, you should use $.getJSON and provide a callback=yourFunction (or similar) to the URL so you are in fact requesting a JSONP.<br><a href="https://www.mediawiki.org/wiki/Topic:Smsi5v9mg0po0dn0" target="_blank" rel="external">引用来源</a></p><br></blockquote><br><p>上面黑体句子的意思，重点说下：</p><br><p>在调用Wiki的API时，第一次我是这么写的：</p><br><pre><code>var url = &#39;…/api.php?action=opensearch&amp;prop=revi&#39; +<br>&#39;sions&amp;rvprop=content&amp;format=json&amp;search=&#39;;<br>var search_text = &#39;taylor swift&#39;; //这个搜索信息是动态获取的，为了方便，我这里写死了。<br>var url = url + search_text;<br><br>$.ajax({<br>    url: url,<br>    dataType: json,<br>    success:function(data){<br>        console.log(data[1]);<br>    }<br>    });<br></code></pre><p>结果出问题，就是文章开始说的那个。</p><br><p>第二次我写时，只改了方法：</p><br><pre><code>……//跟上面一样。<br><br>$.getJSON(url,{<br>            dtype: &#39;json&#39;,<br>        },function(data){<br>            console.log(1,data[1]);<br>        });<br></code></pre><p>还是同样问题。</p><br><p>然后我又去看上面那段英文，认真想了想黑体字部分的意思，写了第三遍：</p><br><pre><code>var url = &#39;<a href="https://en.wikipedia.org/w/api.php?callback=?&amp;#39">https://en.wikipedia.org/w/api.php?callback=?&amp;#39</a>;; //看这里有变化了<br>var search_text = &#39;taylor swift&#39;;<br><br>$.getJSON(url,{<br>            dtype: &#39;json&#39;,<br>            search: search_text,<br>            format: &#39;json&#39;,<br>            action: &#39;opensearch&#39;,<br>        },function(data){<br>            console.log(1,data[1]);<br>        });<br></code></pre><p>correct.</p>
</section></div><script src="/js/jquery.min.js"></script><script src="/js/highlight.min.js"></script><script src="/js/start.js"></script></body></html>